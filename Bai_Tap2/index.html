<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Bai Tap 2</title>
    <style>
        td {
            padding-right: 100px;
        }
    </style>
</head>

<body>
    <table class="table">
        <tr>
            <td>nhap :<input type="text" name="aaaa" id="valuanhap1" data-id="" value="2" /></td>
            <td>nhap :<input type="text" name="bbbb" id="valuanhap2" data-id="" value="2" /></td>
            <td>nhap :<input type="text" name="cccc" id="valuanhap3" data-id="" value="2" /></td>
        </tr>
        <tr>
            <td>Qty1 :<input type="text" value="0" name="qty1" data-id="sum1" data-idget="1" data-idlabel="1" />
                ketqua :
                <label class="kq1" id="label11">0</label>
            </td>
            <td>Qty1 :<input type="text"value="0" name="qtya1" data-id="sum2" data-idget="2" data-idlabel="1" />
                ketqua :
                <label class="kq2" id="label21">0</label>
            </td>
            <td>Qty1 :<input type="text" value="0" name="qtyb1" data-id="sum3" data-idget="3" data-idlabel="1"/>
                ketqua :
                <label class="kq3" id="label31">0</label>
            </td>
        </tr>
        <tr>
            <td>Qty1 :<input type="text" value="0" name="qty1" data-id="sum1" data-idget="1" data-idlabel="2" />
                ketqua :
                <label class="kq1" id="label12">0</label>
            </td>
            <td>Qty1 :<input type="text" value="0" name="qtya1" data-id="sum2" data-idget="2" data-idlabel="2" />
                ketqua :
                <label class="kq2" id="label22">0</label>
            </td>
            <td>Qty1 :<input type="text" value="0" name="qtyb1" data-id="sum3" data-idget="3" data-idlabel="2" />
                ketqua :
                <label class="kq3" id="label32">0</label>
            </td>
        </tr>
        <tr>
            <td>Qty1 :<input type="text" value="0" name="qty1" data-id="sum1" data-idget="1" data-idlabel="3" />
                ketqua :
                <label class="kq1" id="label13">0</label>
            </td>
            <td>Qty1 :<input type="text" value="0" name="qtya1" data-id="sum2" data-idget="2" data-idlabel="3" />
                ketqua :
                <label class="kq2" id="label23">0</label>
            </td>
            <td>Qty1 :<input type="text" value="0" name="qtyb1" data-id="sum3" data-idget="3" data-idlabel="3" />
                ketqua :
                <label class="kq3" id="label33">0</label>
            </td>
        </tr>
        <tr>
            <td>Qty1 :<input type="text" value="0" name="qty1" data-id="sum1" data-idget="1" data-idlabel="4" />
                ketqua :
                <label class="kq1" id="label14">0</label>
            </td>
            <td>Qty1 :<input type="text" value="0" name="qtya1" data-id="sum2" data-idget="2" data-idlabel="4" />
                ketqua :
                <label class="kq2" id="label24">0</label>
            </td>
            <td>Qty1 :<input type="text" value="0" name="qtyb1" data-id="sum3" data-idget="3" data-idlabel="4" />
                ketqua :
                <label class="kq3" id="label34">0</label>
            </td>
        </tr>
        <tr>
            <td>Qty1 :<input type="text" value="0" name="qty1" data-id="sum1" data-idget="1" data-idlabel="5" />
                ketqua :
                <label class="kq1" id="label15">0</label>
            </td>
            <td>Qty1 :<input type="text" value="0" name="qtya1" data-id="sum2" data-idget="2" data-idlabel="5" />
                ketqua :
                <label class="kq2" id="label25">0</label>
            </td>
            <td>Qty1 :<input type="text" value="0" name="qtyb1" data-id="sum3" data-idget="3" data-idlabel="5" />
                ketqua :
                <label class="kq3" id="label35">0</label>
            </td>
        </tr>
        <tr>
            <td>Total :
                <input type="text" name="total" id="1"  value="0"/></td>
            <td>Total :
                <input type="text" name="total" id="2" value="0"/></td>
            <td>Total :
                <input type="text" name="total" id="3" value="0"/></td>
        </tr>
    </table>

    <script src="./jquery/jquery-3.4.1.min.js"></script>
    <script>
        jQuery(document).ready(function ($) {

            $('input[type=text]').on('focusin', function(){
                var idget = $(this).attr('data-idget');
                var idlabel = $(this).attr('data-idlabel');
                $(this).data('val', $(this).val());
                $(this).data('val_total', $("#"+idget).val());
                $(this).data('val_lable', $("#label" + idget + idlabel).text());
            });

            $('input[type=text]').on('change', function(){
                var idget = $(this).attr('data-idget');
                var idlabel = $(this).attr('data-idlabel');
                var valuenhap = $("#valuanhap" + idget).val();
                var tong = ($(this).val() * valuenhap);
                $("#label" + idget + idlabel).text(tong);
            
                var val_total = $(this).data('val_total');
                var val_lable = $(this).data('val_lable');
                var prev = parseInt($(this).data('val'));
                var current = parseInt($(this).val());
                
                var sum = current > prev ? (current - prev)*valuenhap + parseInt(val_total) :
                        (parseInt(val_total) - val_lable + parseInt($("#label" + idget + idlabel).text()));

                $("#"+idget).val(sum);
            });
        });
    </script>
</body>

</html>